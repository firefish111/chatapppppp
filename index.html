<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.5">
    <title>Chat</title>
    <style>
      @import url('https://fonts.googleapis.com/css?family=Montserrat&display=swap');
      ::-webkit-scrollbar {
        width: 10px;
      }

      /* Track */
      ::-webkit-scrollbar-track {
        background: rgb(21, 52, 77); 
      }
      
      /* Handle */
      ::-webkit-scrollbar-thumb {
        background: linear-gradient(to bottom, blue, darkblue); 
        border-radius:20px;
        left:10px;
      }

      /* Handle on hover */
      ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(to bottom, lightblue, blue); 
      }
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      hr {border:0.5px solid rgb(63, 69, 93)}
      #message {background: rgb(26, 65, 97); border-radius: 200px;padding: 10px; width:100%;}
      #message:hover {background:rgb(21, 52, 77)}
      #chat_form { z-index:2;height:5%; background: black; position: fixed; bottom: 1.825%; width: 67.6%; right:2.5%;}
      #chat_input { border-bottom-left-radius: 10px; border-top-left-radius: 10px; border:none; padding: 10px; padding-left:15px; width: 85%; height:100%; margin-right:-5%;}
      #chat_input:focus { outline: none}
      #chat_button { width: 7%; background: blue; border: none; padding: 10px; border-bottom-right-radius: 10px; border-top-right-radius: 10px; transition: background 0.5s;}
      #chat_button:hover { background: darkblue}
      #chat_button:focus { outline: none;}
      #sign_in_input {position:fixed; width:17%; height:5%; bottom:1.8%; border-radius:10px; background:white; left:10%}
      #sign_in_input:focus {outline:none}
      #play_button {z-index:1;font-size:12px; position:fixed; left:23%; bottom:1.8%; height:5%; width: 7%; background: blue; border: none; padding: 10px; border-bottom-right-radius: 0px; border-top-right-radius: 0px; transition: background 0.5s;}
      #play_button:hover {background: darkblue}
      #play_button:focus {outline:none}
      
    </style>
  </head>
  <body style="background:black">
    <div id="messages" style="color:cyan; word-wrap: break-word; line-height:1; font-size:15px; overflow-y:scroll;position:fixed; bottom:10%; width:80%;height:calc(100% - 80px); border-radius:10px; border:20px solid rgb(21, 52, 77); font-family: Montserrat; padding: 15px; left:10%; background:rgb(21, 52, 77)" />
    <form id="chat_form" action="">
      <input id="chat_input" placeholder="Type your message here after setting your username" autocomplete="off" /><button id="chat_button">Send</button>
    </form>
    <form id = "sign_in_form" action="">
      <input id="sign_in_input" placeholder="Type your username" id="sign_in_form" style="border:none; font-size:12px; padding-left:30px">
    </form>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
    var user = "";
    $(function () {
      $("#sign_in_input").on({
        keydown: function(e) {
        if (e.which === 32)
          return false;
        },
        change: function() {
          this.value = this.value.replace(/\s/g, "");
        }
      });
      var socket = io();
      $('#chat_form').submit(function(e){
        e.preventDefault(); // prevents page reloading
        socket.emit('chat message', $('#chat_input').val(), $('#sign_in_input').val());
        return false;
      });
      $('#sign_in_form').submit(function(e){
        e.preventDefault();
        console.log('Username set');
        var use = $('#sign_in_input').val();
        socket.emit('sign in', use);
      });
      socket.on('chat message', function(msg, use){
        if ((use !== '') && (msg !== '')) {
          $('#messages').append("<div id='message'><b>" + use + "</b>: " + msg + "</div><br>");
          if (use == $('#sign_in_input').val()) {
            $('#chat_input').val('');
          }
        }
        $('#messages').scrollTop(90000000000000000000000000000);
      });
      socket.on('sign in', function (username){
        if (username == $('#sign_in_input').val()) {
          $('#messages').append("[Chat Manager] You have set your username to <b>" + username + "</b>.");
        }
        $('#messages').scrollTop(900000000000000000000000000000);
      });
    });
    </script>
  </body>
</html>